"use strict";var constrainValue=function(e){var t=e.target,r=parseInt(t.value,10),n=parseInt(t.min,10),a=parseInt(t.max,10);""===r||r<n?r=n:r>a&&(r=a),t.value=r},displayError=function(e){var t=$('<li class="error">\n      <span class="error-timestamp">'+(new Date).toLocaleString()+':</span>\n      <span class="error-message">'+e+'</span>\n      <button type="button" class="error-dismiss">â¨‰</span>\n    </li>');t.on("click",dismissError),t.hide(),$("#errors").append(t),t.fadeIn()},dismissError=function(e){var t=$(e.target).parent(".error");$(e.target).parent(".error").fadeOut(400,function(){t.remove()})},API=function(){var e="http://lightwall.carnegielibrary.org/",t=axios.create({baseURL:e,auth:{username:"admin",password:"400Brownsville"}}),r=function(e,t){return axios.get(e)},n=function(e,t){return axios.post(e,t)},a=function(){return t.get("status")},s=function(){return t.get("turnOn")},u=function(){return t.get("turnOff")},o=function(){return t.get("hardReset")},i=function(e){return t.get("pause",{minutes:e})};return{rootUrl:e,get:r,post:n,requestStatus:a,requestPowerOn:s,requestPowerOff:u,requestReset:o,requestPause:i}}(),Power=function(){var e=function(e){API.requestPowerOn().then(function(e){refreshStatus()})["catch"](function(e){displayError("There was a problem communicating with the light wall.")})},t=function(e){API.requestPowerOff().then(function(e){refreshStatus()})["catch"](function(e){displayError("There was a problem communicating with the light wall.")})},r=function(){confirm("This will physically restart the light wall system. Are you sure you want to do this?")&&API.requestReset().then(function(e){alert("The system is restarting. Please wait a few minutes.")})["catch"](function(e){displayError("There was a problem communicating with the light wall.")})};return{on:e,off:t,restart:r}}();$("#power-on").on("click",Power.on),$("#power-off").on("click",Power.off),$("#power-restart").on("click",Power.restart);var refreshStatus=function(e){var t=$("#loading");t.fadeIn(400,function(){window.setTimeout(function(){API.requestStatus().then(function(e){$("#status").removeClass().addClass("status-"+e.data.status).html(e.data.status),$("#frame-rate").html(e.data.frameRate),e.data.resumeAt?refreshResumeAt(e.data.resumeAt):$("#resume-at").fadeOut(400),t.fadeOut(400)})["catch"](function(e){$("#status").removeClass().html("unkown"),$("#scene").html("unknown"),$("#frame-rate").html("unkown"),displayError("There was a problem resolving the current status of light wall."),t.fadeOut(400)})},2e3)})},refreshResumeAt=function(e){$("#resume-at-time").html(e),$("#resume-at").show(400)},pauseAmbientAnimation=function(e){var t=$("#pause-minutes").val();API.requestPause(t).then(function(e){refreshStatus(),refreshResumeAt(e.data.resumeAt)})["catch"](function(e){displayError('Your "pause" request was unable to be processed by the light wall server.')})};$("#admin input[type=number]").on("change",constrainValue),$("#refresh-status").on("click",refreshStatus),$("#pause").on("click",pauseAmbientAnimation),refreshStatus();